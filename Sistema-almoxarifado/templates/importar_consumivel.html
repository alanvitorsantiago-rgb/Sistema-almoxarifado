<!-- /templates/importar_consumivel.html -->
{% extends 'base.html' %}

{% block title %}Importar Consum√≠veis - Almoxarifado{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h3><i class="fas fa-file-excel"></i> Importar Planilha de Consum√≠veis</h3>
    <a href="{{ url_for('consumivel') }}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Voltar</a>
</div>

<div class="card">
    <div class="card-header bg-light">
        <h5 class="mb-0">Instru√ß√µes para Importa√ß√£o</h5>
    </div>
    <div class="card-body">
        <p class="mb-2"><strong>A planilha deve conter as seguintes colunas obrigat√≥rias:</strong></p>
        <ul class="list-unstyled">
            <li>‚úì <strong>N¬∫ PRODUTO</strong> - N√∫mero √∫nico do produto</li>
            <li>‚úì <strong>C√ìDIGO PRODUTO</strong> - C√≥digo identificador do produto</li>
            <li>‚úì <strong>DESCRI√á√ÉO DO PRODUTO</strong> - Descri√ß√£o do produto</li>
            <li>‚úì <strong>UNIDADE MEDIDA</strong> - Unidade de medida (UN, CX, KG, L, etc)</li>
        </ul>
        
        <p class="mb-2"><strong>Colunas opcionais (recomendadas):</strong></p>
        <ul class="list-unstyled">
            <li>STATUS ESTOQUE - Status do item (Ativo, Inativo)</li>
            <li>STATUS CONSUMO - Status de consumo (Consum√≠vel, Material Espec√≠fico)</li>
            <li>CATEGORIA - Categoria do produto (Papel, Ferramentas, Tintas, etc)</li>
            <li>FORNECEDOR - Fornecedor principal</li>
            <li>FORNECEDOR 2 - Fornecedor alternativo</li>
            <li>VALOR UNIT√ÅRIO - Valor unit√°rio do produto</li>
            <li>LEAD TIME - Tempo de reposi√ß√£o em dias</li>
            <li>% ESTOQUE DE SEGURAN√áA - Percentual de seguran√ßa</li>
            <li>ESTOQUE M√çNIMO POR ATUALIZAR - Quantidade m√≠nima</li>
            <li>ESTOQUE ATUAL - Quantidade atual em estoque</li>
        </ul>

        <div class="alert alert-info mt-3" role="alert">
            <strong>üìå Dica:</strong> Prepare sua planilha Excel seguindo exatamente estes nomes de colunas. Se voc√™ tem uma planilha diferente, basta renomear as colunas conforme o padr√£o acima.
        </div>
    </div>
</div>

<div class="card mt-4">
    <div class="card-body">
        <form method="post" enctype="multipart/form-data">
            <div class="mb-3">
                <label for="arquivo_excel" class="form-label">Selecione o arquivo Excel (.xlsx)</label>
                <input type="file" class="form-control" id="arquivo_excel" name="arquivo_excel" accept=".xlsx" required>
                <small class="form-text text-muted">Tamanho m√°ximo: 10MB. Apenas arquivos .xlsx s√£o aceitos.</small>
            </div>
            <button type="submit" class="btn btn-primary btn-lg">
                <i class="fas fa-upload"></i> Importar Planilha
            </button>
        </form>
    </div>
</div>
{% endblock %}
